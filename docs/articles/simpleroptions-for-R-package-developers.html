<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>simpleroptions for R package developers • simpleroptions</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">simpleroptions</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simpleroptions-for-R-package-developers.html">simpleroptions for R package developers</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lucacerone/simpleroptions/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>simpleroptions for R package developers</h1>
                        <h4 class="author">Luca Cerone</h4>
            
            <h4 class="date">2018-01-13</h4>
          </div>

    
    
<div class="contents">
<p><code>simpleroptions</code> implements a simple framework to manage option files in your packages and scripts, although I think is in packages were it is the most useful.</p>
<p>To use it is very simple, in your package you create an <code>OptionsManager</code> object (or more) that you can export and document as a normal function.</p>
<p>To create an <code>OptionManager</code> is as easy as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(simpleroptions)
pkgOpt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/OptionsManager.html">OptionsManager</a></span>(<span class="st">"~/.simpleroptions_vignette/example.json"</span>,
                        <span class="dt">default_options =</span> <span class="kw">list</span>(<span class="dt">option_1 =</span> <span class="st">"value_1"</span>,
                                               <span class="dt">option_2 =</span> <span class="dv">1234</span>)
                        )</code></pre></div>
<p>When the code is run the first time <code>simpleroptions</code> takes care of creating the directories that are needed and creates the file <code>example.json</code> in the directory <code>~/.simpleroptions_vignette</code>, containing the list <code>default_options</code> stored as a json object. The permissions of the newly created files are set by default to “600” (read and write for the user who created only), although this only applies to Linux and Mac, in Windows this isn’t true. You can change the permissions of the file using <code>permissions =</code> when you call <code>OptionsManager</code>.</p>
<p>The next time pkgOpt is instantiated, simpleroptions realizes that the file <code>~/.simpleroptions_vignette/example.json</code> already exists and reads the options values from the file rather than using the values provided in <code>default_options</code>.</p>
<p><code>pkgOpt</code> is an R6 object of class OptionsManager that has mainly two methods: <code>get</code> and <code>set</code>.</p>
<p>As the names imply, <code>get</code> is used to get the option values, <code>set</code> is used to set the value of an option. By default when <code>set</code> is called the value is also changed in the json file (if you want to disable this use <code>auto_save = FALSE</code> when you call <code>OptionsManager</code>).</p>
<p>You can use <code>get</code> for the default value of your function arguments, for example</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myfun &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">x =</span> pkgOpt<span class="op">$</span><span class="kw">get</span>(<span class="st">"option_1"</span>)) {
  <span class="kw">print</span>(x)
}

<span class="kw">myfun</span>()</code></pre></div>
<pre><code>## [1] "new_value_1"</code></pre>
<p>If you try to get a value that is not defined an error is thown:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pkgOpt<span class="op">$</span><span class="kw">get</span>(<span class="st">"option_3"</span>)</code></pre></div>
<pre><code>## Error in pkgOpt$get("option_3"): Option 'option_3' not found.</code></pre>
<p>If you export the <code>pkgOpt</code> object, your users will be able to change the options to their desired values using <code>set</code>, for example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pkgOpt<span class="op">$</span><span class="kw">set</span>(<span class="dt">option_1 =</span> <span class="st">"new_value_1"</span>, <span class="dt">option_2 =</span> <span class="dv">9999</span>)</code></pre></div>
<p>You can see that the values have been changed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">myfun</span>()</code></pre></div>
<pre><code>## [1] "new_value_1"</code></pre>
<p>and in the file too:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(readr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/readr/topics/read_file">read_file</a></span>(<span class="st">"~/.simpleroptions_vignette/example.json"</span>))</code></pre></div>
<pre><code>## {
##   "option_1": ["new_value_1"],
##   "option_2": [9999],
##   "option_3": ["unknown_option"]
## }</code></pre>
<p>To see the values currently in use you can access</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pkgOpt<span class="op">$</span>current_options</code></pre></div>
<pre><code>## $option_1
## [1] "new_value_1"
## 
## $option_2
## [1] 9999
## 
## $option_3
## [1] "unknown_option"</code></pre>
<p>Note that by default a user can set options that you didn’t specify in default_options, for example</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pkgOpt<span class="op">$</span><span class="kw">set</span>(<span class="dt">option_3 =</span> <span class="st">"unknown_option"</span>)
pkgOpt<span class="op">$</span>current_options</code></pre></div>
<pre><code>## $option_1
## [1] "new_value_1"
## 
## $option_2
## [1] 9999
## 
## $option_3
## [1] "unknown_option"</code></pre>
<p>If you want to prevent this, you can use the option <code>strict = TRUE</code> when creating the <code>ObjectManager</code>.</p>
<p>We can simulate what would happen in that case:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pkgOpt<span class="op">$</span>strict &lt;-<span class="st"> </span><span class="ot">TRUE</span>
pkgOpt<span class="op">$</span><span class="kw">set</span>(<span class="dt">option_3 =</span> <span class="st">"new_unknown"</span>)</code></pre></div>
<pre><code>## Error in private$set_option(option_name, args_list[[option_name]]): You can't set option " option_3.
## Allowed values are 'option_1','option_2'.</code></pre>
<p>The main reason <code>strict</code> is not enabled by default is because as you develop your package you might want to add new options. With the current implementation when the user upgrades to the new version, <code>simpleroptions</code> would throw an error, which is why at the moment <code>strict = FALSE</code> the default behaviour.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Luca Cerone.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
